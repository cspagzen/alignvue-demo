<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Management Board</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    
<!-- Sidebar Navigation -->
<div class="sidebar-overlay" id="sidebar-overlay"></div>

<nav class="sidebar-nav" id="sidebar-nav">
   <div class="sidebar-content">
       
       
       
       <!-- Account Profile Section -->
<div class="sidebar-account-profile">
    <div class="flex items-center gap-3 cursor-pointer hover:bg-purple-600 hover:bg-opacity-20 rounded-lg p-2 transition-colors" onclick="showAccountModal()">
        <div class="account-avatar w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm">
    CS
</div>
        <div class="sidebar-account-info flex-1">
            <div class="text-white font-medium text-sm">Chris S.</div>
            <div class="text-gray-400 text-xs">Premium Plan</div>
        </div>
    </div>
</div>
       
<!-- Search Section in Sidebar -->
<div class="px-4 py-3 border-b border-gray-600 mb-2">
    <div class="relative">
    <input type="text" id="global-search" placeholder="Search..." 
           class="w-full px-3 py-2 pl-8 pr-10 bg-slate-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm text-white placeholder-gray-400">
    <button id="clear-search" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-200 hidden">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
    </button>
</div>
    
    
    <!-- Search Suggestions Dropdown -->
    <div id="search-suggestions" class="fixed bg-slate-700 border border-gray-600 rounded-lg shadow-lg mt-1 hidden z-50 max-h-64 overflow-y-auto" style="top: 160px; left: 200px; width: 400px;">
        <!-- Suggestions will be populated by JavaScript -->
    </div>
</div>
 
       <!-- Quick Navigation -->
<div class="sidebar-section-title">
    NAVIGATION
</div>

<a href="#" class="sidebar-nav-item active" data-section="initiatives" data-tooltip="Initiatives">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m3 8 4-4 4 4"/>
        <path d="M7 4v16"/>
        <path d="M11 12h4"/>
        <path d="M11 16h7"/>
        <path d="M11 20h10"/>
    </svg>
    <span>Initiatives</span>
</a>

<a href="#" class="sidebar-nav-item" data-section="teams" data-tooltip="Team Health">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m14.479 19.374-.971.939a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5a5.2 5.2 0 0 1-.219 1.49"/>
        <path d="M15 15h6"/>
        <path d="M18 12v6"/>
    </svg>
    <span>Team Health</span>
</a>
     
<a href="#" class="sidebar-nav-item" data-section="portfolio-pulse" data-tooltip="Portfolio Pulse">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"/>
    </svg>
    <span>Portfolio Pulse</span>
</a>


       
<!-- Quick Filters Section -->
<div class="px-2 py-3 border-t border-gray-600 mt-3">
    <div class="sidebar-section-title">
        QUICK FILTERS
    </div>
    
    <!-- Collapsed state - single filter icon -->
    <div class="sidebar-collapsed-filter">
        <a href="#" class="sidebar-nav-item" data-action="toggle-quick-filters" data-tooltip="Quick Filters">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"/>
            </svg>
            <span>Quick Filters</span>
        </a>
    </div>
    
    <!-- Expanded state - individual quick filters -->
    <div class="sidebar-expanded-filters">
        <a href="#" class="sidebar-nav-item" data-action="quick-filter" data-filter-type="high-risk-initiatives" data-tooltip="High Risk Initiatives">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
                <path d="M12 9v4"/>
                <path d="M12 17h.01"/>
            </svg>
            <span>High Risk Initiatives</span>
        </a>
        
        <a href="#" class="sidebar-nav-item" data-action="quick-filter" data-filter-type="market-risk-exposure" data-tooltip="Market Risk Exposure">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"/>
                <path d="M12 15h.01"/>
                <path d="M12 7v4"/>
            </svg>
            <span>Market Risk Exposure</span>
        </a>
        
        <a href="#" class="sidebar-nav-item" data-action="quick-filter" data-filter-type="critically-overloaded-teams" data-tooltip="Critically Overloaded Teams">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2c1 3 2.5 3.5 3.5 4.5A5 5 0 0 1 17 10a5 5 0 1 1-10 0c0-.3 0-.6.1-.9a2 2 0 1 0 3.3-2C8 4.5 11 2 12 2Z"/>
                <path d="m5 22 14-4"/>
                <path d="m5 18 14 4"/>
            </svg>
            <span>Critically Overloaded Teams</span>
        </a>
        
        <a href="#" class="sidebar-nav-item" data-action="quick-filter" data-filter-type="blocked-initiatives" data-tooltip="Blocked Initiatives">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2.586 16.726A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2h6.624a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586z"/>
            </svg>
            <span>Blocked Initiatives</span>
        </a>
    </div>
</div>
       
       <!-- Add Initiative Button -->
<div class="px-2 py-3 border-t border-gray-600 mt-3">
    <a href="#" class="sidebar-nav-item sidebar-add-item" data-action="add-initiative" data-tooltip="Add Initiative">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14"/>
        <path d="M12 5v14"/>
    </svg>
    <span>Add Initiative</span>
</a>
</div>
       
<!-- AlignVue Branding -->
<div class="sidebar-branding">
    <div class="sidebar-branding-content">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sidebar-brand-icon cursor-pointer" onclick="document.getElementById('sidebar-toggle').click()">
            <path d="m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z"/>
            <circle cx="12" cy="12" r="10"/>
        </svg>
        <span class="sidebar-brand-text">AlignVue</span>
    </div>
</div> 
       
    </div>
   
   <button class="sidebar-toggle" id="sidebar-toggle">
    <svg width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 18l6-6-6-6"/>
    </svg>
</button>
</nav>
    
    

    
<!-- Portfolio Filter Drawer -->
<div id="portfolio-filter-drawer" class="hidden">
    <div class="drawer-header">
        <div class="flex items-center justify-between">
            <h3>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m3 8 4-4 4 4"/>
                    <path d="M7 4v16"/>
                    <path d="M11 12h4"/>
                    <path d="M11 16h7"/>
                    <path d="M11 20h10"/>
                </svg>
                Portfolio Filters
            </h3>
            <button id="close-portfolio-drawer" class="drawer-close-btn">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
    </div>
    
    <div class="drawer-content">
        <!-- Initiative Types -->
        <div class="filter-section expanded" data-section="initiative-types">
            <div class="filter-section-header">
                <h4 class="filter-section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-top-icon lucide-panel-top">
                        <rect width="18" height="18" x="3" y="3" rx="2"/>
                        <path d="M3 9h18"/>
                    </svg>
                    Initiative Types
                </h4>
                <svg class="filter-section-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m6 9 6 6 6-6"/>
                </svg>
            </div>
            <div class="filter-section-content">
                <div class="space-y-1">
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="type" data-value="strategic">
                            <span class="filter-option-text">Strategic</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded" style="background: #06b6d4; display: block;"></span>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="type" data-value="ktlo">
                            <span class="filter-option-text">KTLO/Tech</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded" style="background: #8b5cf6; display: block;"></span>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="type" data-value="emergent">
                            <span class="filter-option-text">Emergent</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded" style="background: #ec4899; display: block;"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Validation Status -->
        <div class="filter-section" data-section="validation-status">
            <div class="filter-section-header">
                <h4 class="filter-section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/>
                        <path d="m9 12 2 2 4-4"/>
                    </svg>
                    Validation Status
                </h4>
                <svg class="filter-section-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m6 9 6 6 6-6"/>
                </svg>
            </div>
            <div class="filter-section-content">
                <div class="space-y-1">
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="validation" data-value="validated">
                            <span class="filter-option-text">Validated</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/>
                                <path d="m9 12 2 2 4-4"/>
                            </svg>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="validation" data-value="in-validation">
                            <span class="filter-option-text">In Validation</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-orange)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/>
                                <path d="m9.5 14.5 5-5"/>
                            </svg>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="validation" data-value="not-validated">
                            <span class="filter-option-text">Not Validated</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/>
                                <path d="m9.5 14.5 5-5"/>
                                <path d="m9.5 9.5 5 5"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Priority -->
        <div class="filter-section" data-section="priority">
            <div class="filter-section-header">
                <h4 class="filter-section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m3 8 4-4 4 4"/>
                        <path d="M7 4v16"/>
                        <path d="M11 12h4"/>
                        <path d="M11 16h7"/>
                        <path d="M11 20h10"/>
                    </svg>
                    Priority
                </h4>
                <svg class="filter-section-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m6 9 6 6 6-6"/>
                </svg>
            </div>
            <div class="filter-section-content">
                <div class="space-y-1">
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="priority" data-value="critical">
                            <span class="filter-option-text">Critical</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded-full" style="background: #dc2626; display: block;"></span>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="priority" data-value="high">
                            <span class="filter-option-text">High</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded-full" style="background: #ea580c; display: block;"></span>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="priority" data-value="medium">
                            <span class="filter-option-text">Medium</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded-full" style="background: #d97706; display: block;"></span>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="portfolio-filter-checkbox filter-option-checkbox" data-filter="priority" data-value="low">
                            <span class="filter-option-text">Low</span>
                        </div>
                        <div class="filter-option-icon">
                            <span class="w-3 h-3 rounded-full" style="background: #6b7280; display: block;"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

     
      
    </div>
    
    <div class="drawer-footer">
    <div class="text-center">
        <button id="clear-all-filters-portfolio" class="text-red-400 hover:text-red-300 transition-colors cursor-pointer bg-transparent border-none p-0 font-medium text-sm">
            Clear All Filters
        </button>
    </div>
</div>
</div>

<!-- Team Filter Drawer -->
<div id="team-filter-drawer" class="hidden">
    <div class="drawer-header">
        <div class="flex items-center justify-between">
            <h3>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/>
                </svg>
                Team Health Filters
            </h3>
            <button id="close-team-drawer" class="drawer-close-btn">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
    </div>
    
    <div class="drawer-content">
        <!-- Overall Team Health -->
        <div class="filter-section expanded" data-section="overall-health">
            <div class="filter-section-header">
                <h4 class="filter-section-title">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-icon lucide-heart">
        <path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/>
    </svg>
    Overall Team Health
</h4>
                <svg class="filter-section-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m6 9 6 6 6-6"/>
                </svg>
            </div>
            <div class="filter-section-content">
                <div class="space-y-1">
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="overall-health" data-value="healthy">
                            <span class="filter-option-text">Healthy</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21.801 10A10 10 0 1 1 17 3.335"/>
                                <path d="m9 11 3 3L22 4"/>
                            </svg>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="overall-health" data-value="at-risk">
                            <span class="filter-option-text">At Risk</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-orange)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/>
                                <path d="M12 9v4"/>
                                <path d="M12 17h.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="overall-health" data-value="high-risk">
                            <span class="filter-option-text">High Risk</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#FF5F1F" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 16h.01"/>
                                <path d="M12 8v4"/>
                                <path d="M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="filter-option">
                        <div class="filter-option-label">
                            <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="overall-health" data-value="critical">
                            <span class="filter-option-text">Critical</span>
                        </div>
                        <div class="filter-option-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Updated Team Health Indicators Section -->
<!-- Replace the existing health indicators section in your team filter drawer with this: -->

<div class="filter-section" data-section="health-indicators">
    <div class="filter-section-header">
        <h4 class="filter-section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-plus-icon lucide-heart-plus">
                <path d="m14.479 19.374-.971.939a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5a5.2 5.2 0 0 1-.219 1.49"/>
                <path d="M15 15h6"/>
                <path d="M18 12v6"/>
            </svg>
            Team Health Dimensions
        </h4>
        <svg class="filter-section-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m6 9 6 6 6-6"/>
        </svg>
    </div>
    <div class="filter-section-content">
        <div class="space-y-1">
            
            <!-- Capacity At Risk -->
            <div class="filter-option">
                <div class="filter-option-label">
                    <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="health-indicator" data-value="capacity-risk">
                    <span class="filter-option-text">Capacity at Risk</span>
                </div>
                <div class="filter-option-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 6v6l1.56.78"/>
                        <circle cx="12" cy="12" r="10"/>
                    </svg>
                </div>
            </div>
            
            <!-- Skillset At Risk -->
            <div class="filter-option">
                <div class="filter-option-label">
                    <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="health-indicator" data-value="skillset-risk">
                    <span class="filter-option-text">Skillset at Risk</span>
                </div>
                <div class="filter-option-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                    </svg>
                </div>
            </div>
            
            <!-- Vision At Risk -->
            <div class="filter-option">
                <div class="filter-option-label">
                    <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="health-indicator" data-value="vision-risk">
                    <span class="filter-option-text">Vision at Risk</span>
                </div>
                <div class="filter-option-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                </div>
            </div>
            
            <!-- Support At Risk -->
            <div class="filter-option">
                <div class="filter-option-label">
                    <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="health-indicator" data-value="support-risk">
                    <span class="filter-option-text">Support at Risk</span>
                </div>
                <div class="filter-option-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M7 10v12"/>
                        <path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"/>
                    </svg>
                </div>
            </div>
            
            <!-- Teamwork At Risk -->
            <div class="filter-option">
                <div class="filter-option-label">
                    <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="health-indicator" data-value="teamwork-risk">
                    <span class="filter-option-text">Teamwork at Risk</span>
                </div>
                <div class="filter-option-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                </div>
            </div>
            
            <!-- Autonomy At Risk -->
            <div class="filter-option">
                <div class="filter-option-label">
                    <input type="checkbox" class="team-filter-checkbox filter-option-checkbox" data-filter="health-indicator" data-value="autonomy-risk">
                    <span class="filter-option-text">Autonomy at Risk</span>
                </div>
                <div class="filter-option-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5"/>
                        <path d="M2 12l10 5 10-5"/>
                    </svg>
                </div>
            </div>
            
        </div>
    </div>
</div>
    </div>
    
    <div class="drawer-footer">
    <div class="text-center">
        <button id="clear-all-filters-team" class="text-red-400 hover:text-red-300 transition-colors cursor-pointer bg-transparent border-none p-0 font-medium text-sm">
            Clear All Filters
        </button>
    </div>
</div>
</div>

<!-- Filter Drawer Overlay -->
<div id="drawer-overlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40"></div>

    <div class="main-content" id="main-content" style="margin-top: 0;">
        
    <!-- Unified Filter Chip Bar -->
<div id="filter-chip-bar" class="hidden w-full px-6 py-4 mb-6" style="background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border: 1px solid var(--border-primary); border-radius: 12px; backdrop-filter: var(--glass-blur); box-shadow: var(--shadow-md);">
    <div class="flex items-center flex-wrap gap-3">
    <!-- Clear All Link -->
    <button id="clear-all-chip" class="text-sm font-medium text-red-400 hover:text-red-300 transition-colors cursor-pointer bg-transparent border-none p-0" onclick="clearAllFiltersFromChips()">
        Clear All Filters
    </button>
    
    <!-- Clear Search Results Link -->
    <button id="clear-search-chip" class="text-sm font-medium text-blue-400 hover:text-blue-300 transition-colors cursor-pointer bg-transparent border-none p-0 hidden" onclick="clearSearchFromChips()">
        Clear Search Results
    </button>
        
        <!-- Portfolio Filters Section -->
        <div id="portfolio-chips-section" class="hidden">
            <div id="portfolio-chips" class="flex items-center flex-wrap gap-2"></div>
        </div>
        
        <!-- Separator (only show if both sections have chips) -->
        <div id="filter-separator" class="hidden w-px h-6 mx-2" style="background: var(--border-primary);"></div>
        
        <!-- Team Health Filters Section -->
        <div id="team-chips-section" class="hidden">
            <div id="team-chips" class="flex items-center flex-wrap gap-2"></div>
        </div>
    </div>
</div>
        
    <div class="board-container">
        <div class="pyramid-section">
            <div style="background: var(--bg-secondary); border: 1px solid var(--border-primary); box-shadow: var(--shadow-lg);" class="rounded-xl">
                <div class="px-6 py-4" style="background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);">
    <h2 class="text-lg font-bold text-white flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m3 8 4-4 4 4"/>
        <path d="M7 4v16"/>
        <path d="M11 12h4"/>
        <path d="M11 16h7"/>
        <path d="M11 20h10"/>
    </svg>
    Portfolio Prioritization
</h2>
    <p class="text-sm" style="color: var(--text-secondary);">Drag and drop to reprioritize | Hover over initiatives to highlight associated teams | Click initiatives for details</p>
</div>
               <div class="px-6 py-3 bg-gray-50 border-t border-gray-200">
    <div class="flex items-center gap-6 text-xs flex-wrap">
        <!-- Left side: Legend items -->
        <div class="flex items-center gap-6 flex-wrap">
            <!-- Filter Icon - Leftmost Position -->
            <button id="portfolio-filter-toggle" class="p-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center" style="color: var(--text-muted);" title="Filter initiatives">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
                </svg>
            </button>
            
            <div class="flex items-center gap-3">
                <span class="font-bold text-gray-700">Initiative Types:</span>
                <div class="flex gap-2">
                    <div class="flex items-center gap-1">
    <div class="w-3 h-3 rounded" style="background: #06b6d4;"></div>
    <span>Strategic</span>
</div>
<div class="flex items-center gap-1">
    <div class="w-3 h-3 rounded" style="background: #8b5cf6;"></div>
    <span>KTLO/Tech</span>
</div>
<div class="flex items-center gap-1">
    <div class="w-3 h-3 rounded" style="background: #ec4899;"></div>
    <span>Emergent</span>
</div>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <span class="font-bold text-gray-700">Validation:</span>
                <div class="flex gap-2">
                    <div class="flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="m9 12 2 2 4-4"/></svg>
                        <span>Validated</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-orange)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="m9.5 14.5 5-5"/></svg>
                        <span>In Validation</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="m9.5 14.5 5-5"/><path d="m9.5 9.5 5 5"/></svg>
                        <span>Not Validated</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
                <div class="relative">
                    <div class="pyramid-viewport" id="pyramid-viewport">
                        <div class="pyramid-content" id="pyramid-content">
                            <div id="priority-matrix"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="team-section">
            <div style="background: var(--bg-secondary); border: 1px solid var(--border-primary); box-shadow: var(--shadow-lg);" class="rounded-xl">
                <div class="px-6 py-4 border-b border-gray-200" style="background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-bottom: 1px solid var(--border-primary);">
    <div class="flex items-center gap-20">
        <h2 class="text-lg font-bold text-white flex items-center gap-1">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/>
    </svg>
    Team Health Status
</h2>
        <button onclick="showAddTeamModal()" style="background: var(--accent-primary); color: white;" class="px-3 py-1 rounded text-xs hover:bg-opacity-90 font-medium">+ Add Team</button>
    </div>
    <p class="text-sm" style="color: var(--text-secondary);">Aligned with initiative priorities</p>
</div>
    <div class="px-6 py-3 bg-gray-50 border-t border-gray-200">
    <div class="flex items-center gap-6 text-xs flex-wrap">
        <!-- Filter Icon - Leftmost Position -->
        <button id="team-filter-toggle" class="p-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center" style="color: var(--text-muted);" title="Filter teams">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
            </svg>
        </button>
        
        <div class="flex items-center gap-3">
    <span class="font-bold text-gray-700">Overall Team Health:</span>
    <div class="flex gap-2">
        <div class="flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.801 10A10 10 0 1 1 17 3.335"/><path d="m9 11 3 3L22 4"/></svg>
            <span>Healthy</span>
        </div>
        <div class="flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-orange)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
            <span>At Risk</span>
        </div>
        <div class="flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#FF5F1F" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 16h.01"/><path d="M12 8v4"/><path d="M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z"/></svg>
            <span>High Risk</span>
        </div>
        <div class="flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>
            <span>Critical</span>
        </div>
    </div>
</div>
        <!-- Updated Team Health Legend -->
<!-- Replace the existing legend section with this: -->

<div class="flex items-center gap-3">
    <span class="font-bold text-gray-700">Team Health Dimensions:</span>
    <div class="flex gap-2">
        <div class="flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m14.479 19.374-.971.939a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5a5.2 5.2 0 0 1-.219 1.49"/>
                <path d="M15 15h6"/>
                <path d="M18 12v6"/>
            </svg>
            <span>Healthy</span>
        </div>
        <div class="flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent-red)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m14.876 18.99-1.368 1.323a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5a5.2 5.2 0 0 1-.244 1.572"/>
                <path d="M15 15h6"/>
            </svg>
            <span>At Risk</span>
        </div>
    </div>
</div>
<div class="text-gray-600">
    <span>Hover over any dimension in the grid to see its full name</span>
</div>
        
    </div>
</div>
                <div class="relative">
                    <div class="team-viewport" id="team-viewport">
                        <div class="team-content" id="team-content">
                            <div id="team-health-matrix"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        
<!-- Bento Grid Container -->
<div class="bento-container">
    <div class="px-6 py-4" style="background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);">
    <h2 class="text-lg font-bold text-white flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-activity-icon lucide-activity">
            <path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a .25.25 0 0 1-.48 0L9.24 2.18a .25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"/>
        </svg>
        Portfolio Pulse
    </h2>
    <p class="text-sm" style="color: var(--text-secondary);">Real-time metrics, pipeline management, and strategic insights <span style="color: var(--accent-blue); margin-left: 20px;">Click any card for detailed insights</span></p>
</div>
    
    <div class="bento-grid" id="bento-grid">
        <!-- Pipeline List Card (Large - 2x2) -->
        <div class="bento-card pipeline-card" data-card-type="pipeline">
    <div class="bento-card-header">
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
    <h3 class="bento-card-title" style="margin-bottom: 4px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 12H3"/>
            <path d="M16 18H3"/>
            <path d="M10 6H3"/>
            <path d="M21 18V8a2 2 0 0 0-2-2h-5"/>
            <path d="m16 8-2-2 2-2"/>
        </svg>
        Initiative Pipeline
    </h3>
    <span style="font-weight: normal; color: var(--accent-blue); font-size: 0.75rem; line-height: 1.2; margin-left: 24px;">
        Drag initiatives from the list<br>to the board to start prioritizing
    </span>
</div>
        <span class="bento-card-badge" id="pipeline-count">6</span>
    </div>
    <div class="bento-card-content" id="pipeline-content">
        <!-- Dynamic content will be populated by JavaScript -->
    </div>
</div>

        <!-- OKR Alignment Card (Small - 1x1) -->
<div class="bento-card okr-card" data-card-type="okr">
    <div class="bento-card-header">
        <h3 class="bento-card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 13V2l8 4-8 4"/>
                <path d="M20.561 10.222a9 9 0 1 1-12.55-5.29"/>
                <path d="M8.002 9.997a5 5 0 1 0 8.9 2.02"/>
            </svg>
            OKR Alignment
        </h3>
    </div>
            <div class="bento-card-content" id="okr-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>

        <!-- Initiative Progress Overview Card (Large - 2x1.5) -->
        <div class="bento-card progress-card" data-card-type="progress">
            <div class="bento-card-header">
                <h3 class="bento-card-title">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gauge-icon lucide-gauge">
        <path d="m12 14 4-4"/>
        <path d="M3.34 19a10 10 0 1 1 17.32 0"/>
    </svg>
    Key Results Monitor
</h3>
            </div>
            <div class="bento-card-content" id="progress-overview-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>

        <!-- Team Health Status Card (Small - 1x1) -->
        <div class="bento-card health-card" data-card-type="health">
            <div class="bento-card-header">
                <h3 class="bento-card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/>
                    </svg>
                    Team Health
                </h3>
            </div>
            <div class="bento-card-content" id="health-status-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>

        <!-- Top 3 At-Risk Initiatives Card (Medium - 2x1) -->
<div class="bento-card at-risk-card" data-card-type="at-risk">
    <div class="bento-card-header">
        <h3 class="bento-card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                <path d="M12 9v4"/>
                <path d="M12 17h.01"/>
            </svg>
            Top 3 "At-Risk" Initiatives
        </h3>
    </div>
    <div class="bento-card-content" id="at-risk-content">
        <!-- Dynamic content will be populated by JavaScript -->
    </div>
</div>

        <!-- Resource Alerts Card (Small - 1x1) -->
        <div class="bento-card resource-card" data-card-type="resource">
            <div class="bento-card-header">
                <h3 class="bento-card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                    Workload Distribution
                </h3>
            </div>
            <div class="bento-card-content" id="resource-alerts-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>

        <!-- Delivery Confidence Card (Small - 1x1) -->
<div class="bento-card delivery-confidence-card" data-card-type="delivery-confidence">
    <div class="bento-card-header">
        <h3 class="bento-card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 12l2 2 4-4"/>
                <path d="M21 12c.552 0 1-.448 1-1V5l-8-3-8 3v6c0 .552.448 1 1 1z"/>
            </svg>
            Delivery Confidence
        </h3>
    </div>
    <div class="bento-card-content" id="delivery-confidence-content">
        <!-- Dynamic content will be populated by JavaScript -->
    </div>
</div>

        <!-- Completed Initiatives Card (Medium - 2x1) -->
        <div class="bento-card completed-card" data-card-type="completed">
    <div class="bento-card-header">
        <h3 class="bento-card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m16 16 2 2 4-4"/>
                <path d="M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14"/>
                <path d="m7.5 4.27 9 5.15"/>
                <polyline points="3.29 7 12 12 20.71 7"/>
                <line x1="12" x2="12" y1="22" y2="12"/>
            </svg>
            Recently Completed
        </h3>
    </div>
            <div class="bento-card-content" id="completed-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>

        <!-- Validation Pipeline Card (Small - 1x1) -->
        <div class="bento-card validation-card" data-card-type="validation">
            <div class="bento-card-header">
                <h3 class="bento-card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"/>
                    </svg>
                    Validation Pipeline
                </h3>
            </div>
            <div class="bento-card-content" id="validation-pipeline-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>

        <!-- Mendoza Impact Card (Small - 1x1) -->
        <div class="bento-card mendoza-card" data-card-type="mendoza">
            <div class="bento-card-header">
                <h3 class="bento-card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 3H5"/>
                        <path d="M12 21V7"/>
                        <path d="m6 15 6 6 6-6"/>
                    </svg>
                    Mendoza Impact
                </h3>
            </div>
            <div class="bento-card-content" id="mendoza-impact-content">
    <!-- Gauge Visual -->
    <div class="flex flex-col items-center justify-center h-full space-y-3">
        <!-- Gauge SVG -->
        <div class="relative w-32 h-20">
            <svg viewBox="0 0 160 80" class="w-full h-full">
                <!-- Background arc -->
                <path
                    d="M 20 60 A 60 60 0 0 1 140 60"
                    stroke="#e5e7eb"
                    stroke-width="8"
                    fill="none"
                />
                <!-- Progress arc (40% of 180 degrees = 72 degrees) -->
                <path
                    d="M 20 60 A 60 60 0 0 1 98.4 20.8"
                    stroke="#ef4444"
                    stroke-width="8"
                    fill="none"
                    stroke-linecap="round"
                />
                <!-- Needle -->
                <line
                    x1="80"
                    y1="60"
                    x2="98.4"
                    y2="20.8"
                    stroke="#374151"
                    stroke-width="2"
                />
                <circle cx="80" cy="60" r="3" fill="#374151" />
            </svg>
            
            <!-- Gauge labels -->
            <div class="absolute bottom-0 left-0 text-xs text-gray-500">0%</div>
            <div class="absolute bottom-0 right-0 text-xs text-gray-500">100%</div>
        </div>
        
        <!-- Main metric -->
        <div class="text-center">
            <div class="text-2xl font-bold text-gray-900">40% of capacity</div>
            <div class="text-sm text-gray-600">on low-priority initiatives</div>
        </div>
    </div>
</div>
        </div>
<!-- Critical Team Status Card (Small - 1x1) -->
        <div class="bento-card critical-team-card" data-card-type="critical-team">
            <div class="bento-card-header">
                <h3 class="bento-card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2c1 3 2.5 3.5 3.5 4.5A5 5 0 0 1 17 10a5 5 0 1 1-10 0c0-.3 0-.6.1-.9a2 2 0 1 0 3.3-2C8 4.5 11 2 12 2Z"/>
                        <path d="m5 22 14-4"/>
                        <path d="m5 18 14 4"/>
                    </svg>
                    Critical Team Status
                </h3>
            </div>
            <div class="bento-card-content" id="critical-team-content">
                <!-- Dynamic content will be populated by JavaScript -->
            </div>
        </div>
       
    </div>
</div>        
        
        
    <div id="detail-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 id="modal-title" class="text-xl font-bold"></h2>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div id="modal-content"></div>
        </div>
    </div>
      
      <!-- KPI Edit Modal -->
<div id="kpi-edit-modal" class="modal">
    <div class="modal-content">
        <div class="flex justify-between items-center mb-4">
            <h2 id="kpi-modal-title" class="text-xl font-bold">Update current key result value</h2>
            <button onclick="closeKPIEditModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <div id="kpi-modal-content">
    <div class="space-y-6">
        <!-- Key Result Header -->
        <div class="text-center">
            <div class="mb-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--accent-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-3">
                    <path d="m12 14 4-4"/>
                    <path d="M3.34 19a10 10 0 1 1 17.32 0"/>
                </svg>
            </div>
            <h3 id="kpi-name-display" class="text-lg font-bold mb-2" style="color: var(--text-primary);"></h3>
            <p id="kpi-description" class="text-sm" style="color: var(--text-secondary);"></p>
        </div>

        <!-- Target Value Display -->
        <div class="text-center p-6 rounded-lg" style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-primary-hover)); border: 1px solid var(--accent-primary);">
            <div class="text-sm font-medium text-white opacity-90 mb-1">TARGET VALUE</div>
            <div id="kpi-target-display" class="text-4xl font-bold text-white"></div>
        </div>

        <!-- Current Value Input -->
<div class="space-y-3">
    <div class="text-center">
        <label for="kpi-current-value" class="text-sm font-medium mb-2 block" style="color: var(--text-primary);">Update Current Value</label>
        <div class="custom-number-input relative">
            <input type="number" id="kpi-current-value" 
                   class="w-full px-4 py-3 pr-16 text-center text-4xl font-bold border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" 
                   style="background: var(--bg-quaternary); border-color: var(--border-primary); color: var(--text-primary);" 
                   step="1" placeholder="0">
            <div class="custom-spinner-buttons">
                <button type="button" class="custom-spinner-btn" onclick="incrementKPIValue()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-chevron-up-icon lucide-square-chevron-up"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="m8 14 4-4 4 4"/></svg>
                </button>
                <button type="button" class="custom-spinner-btn" onclick="decrementKPIValue()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-chevron-down-icon lucide-square-chevron-down"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="m16 10-4 4-4-4"/></svg>
                </button>
            </div>
        </div>
    </div>
</div>

        <!-- Action Buttons -->
        <div class="flex gap-3 pt-4">
            <button type="button" onclick="closeKPIEditModal()" 
                    class="flex-1 px-4 py-2 border rounded-md hover:bg-opacity-90 transition-colors" 
                    style="background: var(--bg-quaternary); border-color: var(--border-primary); color: var(--text-primary);">
                Cancel
            </button>
            <button type="button" onclick="saveKPIValue()" 
                    class="flex-1 px-4 py-2 rounded-md hover:bg-opacity-90 transition-colors font-medium" 
                    style="background: var(--accent-primary); color: white;">
                Update Value
            </button>
        </div>
    </div>
</div>
    </div>
</div>
      
<!-- Key Results Detail Modal -->
<div id="kpi-detail-modal" class="modal">
    <div class="modal-content" style="max-width: 800px !important;">
        <div class="flex justify-between items-center mb-4">
            <h2 id="kpi-detail-modal-title" class="text-xl font-bold">Key Result Details</h2>
            <button onclick="closeKPIDetailModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <div id="kpi-detail-modal-content">
            <!-- Content will be populated by JavaScript -->
        </div>
    </div>
</div>
    
<!-- Account Profile Modal -->
<div id="account-modal" class="modal">
    <div class="modal-content">
        <div class="flex justify-between items-center mb-4">
            <h2 id="account-modal-title" class="text-xl font-bold">Account Profile</h2>
            <button onclick="closeAccountModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <div id="account-modal-content">
            <div class="space-y-6">
                <!-- Profile Section -->
                <div class="p-4 rounded-lg" style="background: var(--bg-tertiary); border: 1px solid var(--border-primary);">
                    <h3 class="font-bold mb-3 flex items-center gap-2" style="color: var(--text-primary);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                        Profile Information
                    </h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p style="color: var(--text-secondary);"><strong>Name:</strong> Chris Spagnuolo</p>
                            <p style="color: var(--text-secondary);"><strong>Email:</strong> chris@productforge.com</p>
                            <p style="color: var(--text-secondary);"><strong>Phone:</strong> 1-800-555-1212</p>
                        </div>
                        <div>
                            <p style="color: var(--text-secondary);"><strong>Company:</strong> Product Forge</p>
                            <p style="color: var(--text-secondary);"><strong>Address:</strong> 123 College Avenue<br>Fort Collins, CO 80527</p>
                        </div>
                    </div>
                </div>
                
                <!-- Subscription Section -->
                <div class="p-4 rounded-lg" style="background: var(--bg-tertiary); border: 1px solid var(--accent-green);">
                    <h3 class="font-bold mb-3 flex items-center gap-2" style="color: var(--accent-green);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                        Subscription & Billing
                    </h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p style="color: var(--text-secondary);"><strong>Plan:</strong> Premium Plan</p>
                            <p style="color: var(--text-secondary);"><strong>Billing:</strong> Monthly</p>
                            <p style="color: var(--text-secondary);"><strong>Amount:</strong> $59.99/month</p>
                        </div>
                        <div>
                            <p style="color: var(--text-secondary);"><strong>Next Renewal:</strong> August 1, 2026</p>
                            <p style="color: var(--text-secondary);"><strong>Status:</strong> <span style="color: var(--accent-green);">Active</span></p>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="p-4 rounded-lg" style="background: var(--bg-tertiary); border: 1px solid var(--accent-blue);">
                    <h3 class="font-bold mb-3 flex items-center gap-2" style="color: var(--accent-blue);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                        Account Settings
                    </h3>
                    <div class="space-y-2">
                        <button class="w-full text-left px-3 py-2 rounded text-sm hover:bg-opacity-80" style="background: var(--bg-quaternary); color: var(--text-primary);">Edit Profile Information</button>
                        <button class="w-full text-left px-3 py-2 rounded text-sm hover:bg-opacity-80" style="background: var(--bg-quaternary); color: var(--text-primary);">Change Password</button>
                        <button class="w-full text-left px-3 py-2 rounded text-sm hover:bg-opacity-80" style="background: var(--bg-quaternary); color: var(--text-primary);">Billing & Payment Methods</button>
                        <button class="w-full text-left px-3 py-2 rounded text-sm hover:bg-opacity-80" style="background: var(--bg-quaternary); color: var(--text-primary);">Notification Preferences</button>
                        <button class="w-full text-left px-3 py-2 rounded text-sm hover:bg-opacity-80" style="background: var(--bg-quaternary); color: var(--text-primary);">Team Management</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div> 
    <script src="data.js"></script>
    <script src="script.js"></script>


<script>

// Jira Proxy Integration
async function syncWithJira() {
    try {
        showSyncStatus('Loading initiatives from Jira via proxy...', 'loading');
        
        // Get initiatives via proxy - explicitly request custom fields
        const initiativesResponse = await fetch('/api/jira', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                endpoint: '/rest/api/3/search',
                method: 'POST',
                body: {
    jql: 'project IN (STRAT, KTLO, EMRG) AND issuetype = Epic ORDER BY project ASC',
    fields: ["*all"]
}
            })
        });

        if (!initiativesResponse.ok) {
            const error = await initiativesResponse.json();
            throw new Error(error.error || `HTTP ${initiativesResponse.status}`);
        }

        const initiatives = await initiativesResponse.json();

        // Get OKRs via proxy
        const okrsResponse = await fetch('/api/jira', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                endpoint: '/rest/api/3/search',
                method: 'POST',
                body: {
                    jql: 'project = OKR',
                    maxResults: 20,
                    fields: ['summary', 'issuetype', 'issuelinks', 'parent']
                }
            })
        });

        const okrs = await okrsResponse.json();

        // Ensure boardData.teams exists
        if (!window.boardData || !window.boardData.teams) {
            console.warn('boardData.teams not found, creating default teams');
            window.boardData = window.boardData || {};
            window.boardData.teams = {
                "Core Platform": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "User Experience": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Security": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Data Engineering": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Analytics": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Site Reliability": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Customer Support": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Business Operations": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Mobile Development": { capacity: "healthy", skillset: "healthy", vision: "healthy" },
                "Machine Learning": { capacity: "healthy", skillset: "healthy", vision: "healthy" }
            };
        }

        // Transform data
        const transformedData = transformJiraData(initiatives, okrs);
        updateBoardWithLiveData(transformedData);
        
        showSyncStatus(`Successfully synced ${transformedData.initiatives.length} initiatives!`, 'success');
        
    } catch (error) {
        console.error('Sync failed:', error);
        showSyncStatus(`Sync failed: ${error.message}`, 'error');
    }
}

// Add this helper function for extracting text from Jira doc format
function extractTextFromDoc(docField) {
    if (!docField || !docField.content) return null;
    
    let text = '';
    function extractText(content) {
        content.forEach(item => {
            if (item.type === 'text') {
                text += item.text;
            } else if (item.content) {
                extractText(item.content);
            }
        });
    }
    
    extractText(docField.content);
    return text.trim() || null;
}

// Complete fixed transformJiraData function
// Complete fixed transformJiraData function with proper teams processing
function transformJiraData(initiativesResponse, okrsResponse) {
    // Debug: Check what we're getting from the API
    console.log('Raw API response for first issue:', initiativesResponse.issues[0]);
    console.log('Custom fields in first issue:', Object.keys(initiativesResponse.issues[0].fields).filter(key => key.startsWith('customfield_')));

    // NEW DEBUG: Show all custom field values
    console.log('All custom fields for first issue:');
    const firstIssue = initiativesResponse.issues[0];
    Object.keys(firstIssue.fields).forEach(key => {
        if (key.startsWith('customfield_')) {
            console.log(`${key}:`, firstIssue.fields[key]);
        }
    });
    
    const transformedInitiatives = initiativesResponse.issues.map((issue, index) => {
        const project = issue.fields.project.key;
        const typeMapping = { 'STRAT': 'strategic', 'KTLO': 'ktlo', 'EMRG': 'emergent' };
        
        // Debug the Matrix Position field specifically
        const rawMatrixSlot = issue.fields['customfield_10091'];
        console.log(`${issue.fields.summary}: Raw Matrix Position field =`, rawMatrixSlot, typeof rawMatrixSlot);
        
        const matrixSlot = getFieldValue(issue, 'customfield_10091');
        console.log(`${issue.fields.summary}: Processed Matrix Position =`, matrixSlot, typeof matrixSlot);
        
        const validationStatus = getFieldValue(issue, 'customfield_10052');
        const teamsAssigned = getFieldValue(issue, 'customfield_10053');
        const initiativeType = getFieldValue(issue, 'customfield_10051');
        
        // DEBUG: Log the teams data specifically
        console.log(`${issue.fields.summary} TEAMS DEBUG:`);
        console.log('Raw teams field:', issue.fields['customfield_10053']);
        console.log('Processed teams:', teamsAssigned);
        
        // Handle numeric Matrix Position
        let priority;
        if (matrixSlot === 0 || matrixSlot === null || matrixSlot === undefined) {
            priority = 'pipeline';
        } else if (typeof matrixSlot === 'number' && matrixSlot >= 1 && matrixSlot <= 36) {
            priority = matrixSlot;
        } else {
            priority = 'pipeline';
        }
        
        // FIXED: Process teams correctly - handle Jira select field format AND split concatenated teams
        let processedTeams;
        if (Array.isArray(teamsAssigned)) {
            processedTeams = teamsAssigned.map(team => {
                let teamValue;
                if (typeof team === 'object' && team.value) {
                    teamValue = team.value;
                } else {
                    teamValue = team;
                }
                
                // Split concatenated teams (semicolon separated)
                if (teamValue && teamValue.includes(';')) {
                    return teamValue.split(';').map(t => t.trim());
                }
                return teamValue;
            }).flat(); // Flatten in case we split any teams
        } else if (teamsAssigned && typeof teamsAssigned === 'object' && teamsAssigned.value) {
            const teamValue = teamsAssigned.value;
            if (teamValue.includes(';')) {
                processedTeams = teamValue.split(';').map(t => t.trim());
            } else {
                processedTeams = [teamValue];
            }
        } else if (teamsAssigned) {
            if (teamsAssigned.includes(';')) {
                processedTeams = teamsAssigned.split(';').map(t => t.trim());
            } else {
                processedTeams = [teamsAssigned];
            }
        } else {
            processedTeams = ['Core Platform'];
        }
        
        // Remove any empty strings
        processedTeams = processedTeams.filter(team => team && team.trim());
        
        console.log(`${issue.fields.summary} FINAL TEAMS:`, processedTeams);
        console.log(`${issue.fields.summary}: Final Priority = ${priority}`);
        
        const transformedInitiative = {
            id: parseInt(issue.key.split('-')[1]),
            title: issue.fields.summary,
            type: initiativeType || typeMapping[project] || 'strategic',
validation: validationStatus || 'not-validated',
            priority: priority,
            teams: processedTeams,
            progress: Math.floor(Math.random() * 80) + 10,
            jira: {
                key: issue.key,
                stories: Math.floor(Math.random() * 30) + 10,
                completed: Math.floor(Math.random() * 15) + 5,
                inProgress: Math.floor(Math.random() * 10) + 3,
                blocked: Math.floor(Math.random() * 5),
                velocity: Math.floor(Math.random() * 15) + 5
            },
            canvas: {
    outcome: extractTextFromDoc(getFieldValue(issue, 'customfield_10054')) || 'Outcome to be defined',
    measures: extractTextFromDoc(getFieldValue(issue, 'customfield_10055')) || 'Success measures TBD',
    keyResult: findOKRAlignment(issue, okrsResponse.issues) || 'No OKR',
    marketSize: formatMarketSize(issue),
    customer: getFieldValue(issue, 'customfield_10059') || 'Customer segment TBD',
    problem: extractTextFromDoc(getFieldValue(issue, 'customfield_10060')) || 'Problem statement needed',
    solution: extractTextFromDoc(getFieldValue(issue, 'customfield_10061')) || 'Solution to be defined',
    bigPicture: extractTextFromDoc(getFieldValue(issue, 'customfield_10062')) || 'Vision to be articulated',
    alternatives: extractTextFromDoc(getFieldValue(issue, 'customfield_10063')) || 'Alternatives to be researched'
}
        };
        
        console.log(`TRANSFORMED INITIATIVE ${issue.fields.summary}:`, transformedInitiative);
        return transformedInitiative;
    });

    const activeInitiatives = transformedInitiatives.filter(i => i.priority !== 'pipeline');
    const pipelineInitiatives = transformedInitiatives.filter(i => i.priority === 'pipeline');
    
    console.log(`Active on board: ${activeInitiatives.length}, Pipeline: ${pipelineInitiatives.length}`);
    
    // Add this right after the console.log lines in transformJiraData
    console.log('=== ALL CUSTOM FIELDS DEBUG ===');
    Object.keys(firstIssue.fields).forEach(key => {
        if (key.startsWith('customfield_')) {
            console.log(`${key}: ${JSON.stringify(firstIssue.fields[key])}`);
        }
    });
    console.log('=== END CUSTOM FIELDS DEBUG ===');

    return {
        initiatives: activeInitiatives,
        bullpen: pipelineInitiatives,
        teams: boardData.teams
    };
}

// Make sure getFieldValue handles the object format properly
function getFieldValue(issue, fieldId) {
    const fieldValue = issue.fields[fieldId];
    if (!fieldValue) return null;
    
    if (typeof fieldValue === 'object') {
        if (fieldValue.value) return fieldValue.value;
        if (Array.isArray(fieldValue)) return fieldValue.map(item => item.value || item);
    }
    return fieldValue;
}

// Update formatMarketSize to handle proper field IDs
function formatMarketSize(issue) {
    const tam = getFieldValue(issue, 'customfield_10056');
    const sam = getFieldValue(issue, 'customfield_10057'); 
    const som = getFieldValue(issue, 'customfield_10058');
    
    if (tam || sam || som) {
        const parts = [];
        if (tam) parts.push(`TAM: $${tam}M`);
        if (sam) parts.push(`SAM: $${sam}M`);
        if (som) parts.push(`SOM: $${som}M`);
        return parts.join(', ');
    }
    return 'Market size TBD';
}

// Keep the existing findOKRAlignment function as is
function findOKRAlignment(issue, okrIssues) {
    if (!issue.fields.issuelinks || issue.fields.issuelinks.length === 0) {
        return null;
    }
    
    for (const link of issue.fields.issuelinks) {
        const linkedIssue = link.outwardIssue || link.inwardIssue;
        if (linkedIssue && linkedIssue.key.startsWith('OKR-')) {
            const okrTask = okrIssues.find(okr => okr.key === linkedIssue.key);
            if (okrTask) {
                return okrTask.fields.summary;
            }
        }
    }
    
    return null;
}

function updateBoardWithLiveData(newData) {
    console.log('Updating boardData directly:', newData.initiatives[0]?.title);
    
    boardData.initiatives = newData.initiatives;
    boardData.bullpen = newData.bullpen;
    
    console.log('Verification - boardData now has:', boardData.initiatives[0]?.title);
    
    // Only call functions that exist
    generatePyramid();
    // Skip updateBentoCards since it doesn't exist
    if (typeof updatePipelineCard === 'function') {
        updatePipelineCard();
    }
}

function showSyncStatus(message, type) {
    const existingStatus = document.getElementById('sync-status');
    if (existingStatus) existingStatus.remove();
    
    const status = document.createElement('div');
    status.id = 'sync-status';
    status.style.cssText = `
        position: fixed; top: 20px; right: 20px; padding: 12px 20px;
        border-radius: 6px; color: white; font-weight: 500; z-index: 10000;
        max-width: 300px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    `;
    
    if (type === 'loading') {
        status.style.background = '#2196F3';
        status.innerHTML = `Loading... ${message}`;
    } else if (type === 'success') {
        status.style.background = '#4CAF50';
        status.innerHTML = `Success! ${message}`;
    } else if (type === 'error') {
        status.style.background = '#F44336';
        status.innerHTML = `Error: ${message}`;
    }
    
    document.body.appendChild(status);
    
    if (type !== 'loading') {
        setTimeout(() => status.remove(), 4000);
    }
}

// Add sync button
function addSyncButton() {
    if (document.getElementById('jira-sync-btn')) return;
    
    const syncButton = document.createElement('button');
    syncButton.id = 'jira-sync-btn';
    syncButton.innerHTML = `
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
            <path d="M21 3v5h-5"/>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
            <path d="M3 21v-5h5"/>
        </svg>
        Sync Jira
    `;
    
    syncButton.style.cssText = `
        position: fixed; top: 20px; left: 20px;
        background: var(--accent-blue); color: white; border: none;
        padding: 10px 15px; border-radius: 6px; cursor: pointer;
        display: flex; align-items: center; gap: 8px;
        font-size: 14px; font-weight: 500; z-index: 1000;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    `;
    
    syncButton.addEventListener('click', syncWithJira);
    document.body.appendChild(syncButton);
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    addSyncButton();
});
</script>
    
    </body>
</html>