<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Role-Based Dashboard - AlignVue</title>
    <link rel="stylesheet" href="styles.css">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- AI Chatbot Files - Only essential ones for standalone mode -->
    <link rel="stylesheet" href="/ai-chat/ai-chat-modal.css">
    <script src="/ai-chat/ai-chat-config.js"></script>
    <script src="/ai-chat/ai-chat-modal.js"></script>
</head>
<body class="bg-gray-100">
    
<!-- Sidebar Navigation -->
<div class="sidebar-overlay" id="sidebar-overlay"></div>

<nav class="sidebar-nav" id="sidebar-nav">
   <div class="sidebar-content">
       <!-- Quick Navigation -->
<div class="sidebar-section-title">
    NAVIGATION
</div>

<a href="index.html" class="sidebar-nav-item" data-tooltip="Portfolio Board">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M9 3v18"/>
    </svg>
    <span>Portfolio Board</span>
</a>

<div class="sidebar-section-title mt-4">
    AI DASHBOARDS
</div>

<a href="role-dashboard.html" class="sidebar-nav-item active" data-tooltip="Role Dashboard">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z"/>
    </svg>
    <span>Role Dashboard</span>
</a>

<a href="role-dashboard-conversational.html" class="sidebar-nav-item" data-tooltip="Conversational View">
    <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
    </svg>
    <span>Conversational View</span>
</a>

<!-- AlignVue Branding -->
<div class="sidebar-branding">
    <div class="sidebar-branding-content">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sidebar-brand-icon cursor-pointer" onclick="document.getElementById('sidebar-toggle').click()">
            <path d="m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z"/>
            <circle cx="12" cy="12" r="10"/>
        </svg>
        <span class="sidebar-brand-text">AlignVue</span>
    </div>
</div> 
       
    </div>
   
   <button class="sidebar-toggle" id="sidebar-toggle">
    <svg width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 18l6-6-6-6"/>
    </svg>
</button>
</nav>

    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Inline SVG Icon Components
        const Sparkles = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z"/>
                <path d="M20 2v4"/>
                <path d="M22 4h-4"/>
                <circle cx="4" cy="20" r="2"/>
            </svg>
        );
        
        const Target = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="6"/>
                <circle cx="12" cy="12" r="2"/>
            </svg>
        );
        
        const Users = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
        );
        
        const CheckCircle = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );
        
        const Lightbulb = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/>
                <path d="M9 18h6"/>
                <path d="M10 22h4"/>
            </svg>
        );
        
        const Settings = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                <circle cx="12" cy="12" r="3"/>
            </svg>
        );
        
        const ChevronDown = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="6 9 12 15 18 9"/>
            </svg>
        );
        
        const TrendingUp = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
                <polyline points="16 7 22 7 22 13"/>
            </svg>
        );
        
        const AlertTriangle = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                <line x1="12" y1="9" x2="12" y2="13"/>
                <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
        );
        
        const MessageSquare = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            </svg>
        );
        
        const Loader2 = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
            </svg>
        );

// Simulated AI responses for each role
const aiInsights = {
  executive: {
    businessImpact: {
      query: "What's the business impact of our current portfolio and where are we creating the most value?",
      response: `**Portfolio Value Analysis:**

**Current Quarter Financial Impact:**
- **Revenue Influence:** $8.2M (initiatives directly tied to revenue)
- **Cost Reduction:** $1.4M (efficiency and automation initiatives)
- **Risk Mitigation:** $3.1M (prevented losses from compliance/security)
- **Total Business Value:** $12.7M vs $8.5M investment (1.49x ROI)

**Value Creation by Initiative Type:**
- Strategic Opportunities (65%): $8.2M in customer value
- KTLO/Efficiency (25%): $1.4M in cost savings
- Emergent/Risk (10%): $3.1M in risk mitigation

**Top Value Creators:**
1. **Customer Portal Redesign** - $2.4M revenue potential (Q4 acquisition goal)
2. **Payment Redesign** - $1.8M (conversion improvement)
3. **Analytics v2** - $1.2M (upsell opportunities)

**Top Value Destroyers:**
1. **Strategic Thrashing** - $180K lost productivity (4 priority changes)
2. **Validation Gaps** - $400K at risk (building without customer proof)
3. **Tech Debt** - $95K/month operational drag

**Bottom Line:** We're investing wisely (1.49x ROI), but validation gaps and priority thrashing threaten $2.8M in Q4 value.`
    },
    strategicAlignment: {
      query: "How well are our initiatives aligned to our strategic business objectives?",
      response: `**Strategic Alignment Assessment:**

**Q4 Business Objectives vs Portfolio:**

**Objective 1: Grow Revenue 20% YoY** 
- **Status:** 🟡 At Risk
- **Supporting Initiatives:** 3 (Customer Portal, Payment Redesign, Upsell Engine)
- **Current Impact:** $5.4M projected (need $6.8M for 20% growth)
- **Gap:** $1.4M revenue shortfall
- **Risk:** Customer Portal not validated ($2.4M value at risk)

**Objective 2: Expand Market Position**
- **Status:** ✅ On Track
- **Supporting Initiatives:** 4 (International, Partner API, Multi-tenant)
- **Current Impact:** 2 new markets, 5 strategic partnerships
- **Confidence:** 95%

**Objective 3: Operational Excellence**
- **Status:** 🔴 Behind
- **Supporting Initiatives:** 2 (Monitoring, Infrastructure)
- **Current State:** 92% uptime (target: 95%), 8hr response time (target: 4hr)
- **Impact:** Customer satisfaction risk, potential churn

**Objective 4: Customer Retention**
- **Status:** ✅ Exceeding
- **Supporting Initiatives:** 5 (Onboarding, Support Portal, Mobile App)
- **Current Impact:** Churn reduced 12% (target: 10%)

**Strategic Bets Analysis:**
- 73% of engineering investment aligned to revenue goals ✅
- 15% of portfolio unvalidated (high risk to strategic outcomes) âš ï¸
- 12% of investment in technical foundation (may be underfunded) âš ï¸

**Recommendation:** Validate Customer Portal immediately OR pivot $2.4M investment to validated opportunities. Underfunded operational excellence threatens customer satisfaction.`
    },
    strategicRisks: {
      query: "What are the biggest strategic risks to our business objectives and how do we mitigate them?",
      response: `**Strategic Risk Assessment:**

**🔴 CRITICAL RISK: Revenue Target Miss**
- **Threat:** Q4 revenue target ($6.8M) at risk due to validation gaps
- **Root Cause:** Customer Portal ($2.4M value) built without customer proof
- **Probability:** 35% chance of complete miss
- **Business Impact:** Miss quarterly targets, investor confidence, market position
- **Mitigation:** 
  1. Fast-track Customer Portal validation (2 weeks)
  2. Identify backup revenue opportunities ($1.4M needed)
  3. Consider delaying launch vs shipping wrong solution

**🟡 MEDIUM RISK: Operational Excellence Degradation**
- **Threat:** 92% uptime trending down, incident response slow
- **Root Cause:** Infrastructure investment only 12% of portfolio
- **Probability:** 60% chance uptime drops below 90%
- **Business Impact:** Customer churn, brand damage, SLA penalties
- **Mitigation:** Ring-fence infrastructure team capacity, pause 1-2 feature initiatives

**🟡 MEDIUM RISK: Strategic Thrashing**
- **Threat:** Initiative priorities changed 4 times this quarter
- **Root Cause:** Unclear strategic bets, reactive to market signals
- **Probability:** Will continue without intervention
- **Business Impact:** $180K lost productivity, team morale, execution quality
- **Mitigation:** Freeze priorities for 6 weeks, define strategic framework

**🟢 LOW RISK: Market Expansion**
- **Status:** 2 new markets on track, partnerships strong
- **Confidence:** 95%

**🟢 LOW RISK: Customer Retention**
- **Status:** Exceeding targets (12% churn reduction)
- **Confidence:** 90%

**Portfolio Risk Score: 6.2/10 (Medium Risk)**

**Biggest Leverage Point:** Validate Customer Portal in next 2 weeks. This single action reduces portfolio risk from 6.2 â†’ 4.1 and protects $2.4M in Q4 value.`
    }
  },
  resourceManager: {
    overallocation: {
      query: "Which teams are overallocated and what's the impact on delivery?",
      response: `**Capacity Crisis Overview:**

**3 Teams Over 100% Allocation:**

**Mobile Refresh: 112%**
- 6 engineers juggling 8 initiatives (1.33 per person)
- Sprint velocity down 25% (was 45 points, now 34)
- 3 initiatives slipped last sprint
- Burnout risk: HIGH (2 engineers flagged)

**Web Platform: 105%**
- 5 engineers, 2 on-call rotation (effective capacity: 4)
- Production incidents eating 30% of sprint capacity
- Strategic work being deprioritized

**Design System: 103%**
- 4 designers supporting 12 product teams
- Queue time for design requests: 2-3 weeks
- Becoming a delivery bottleneck

**Healthy Capacity Teams:**
- Data Analytics: 75% (can absorb work)
- Content Platform: 82% (slight room)
- Payments: 85% (at capacity)

**Immediate Actions:**
1. Deprioritize 2 initiatives from Mobile Refresh
2. Hire contractors for Web Platform on-call
3. Limit concurrent design requests to 3 per team`
    },
    rebalancing: {
      query: "How can I rebalance workload across teams more effectively?",
      response: `**Rebalancing Strategy:**

**OPTION 1: Move Work to Available Teams**
- Customer Portal â†’ Data Analytics team (they have mobile experience + 25% capacity)
- Analytics v2 â†’ Delay 1 quarter (not validated anyway)
- Savings: Reduce Mobile Refresh to 95%, keep team healthy

**OPTION 2: Hire Contractors**
- 2 contractors for Web Platform on-call rotation
- Cost: $40K/month
- Benefit: Frees 30% capacity for strategic work
- ROI: Positive if it prevents OKR miss ($2.4M revenue)

**OPTION 3: Pause Low-Impact Work**
- Settings Redesign (current validation: "nice to have")
- Partner API v2 (only 2 partners using it)
- Admin Dashboard refresh (internal tool)
- Savings: 35% capacity across 3 teams

**My Recommendation: Hybrid Approach**
1. Move Customer Portal to Data Analytics (no cost)
2. Hire 1 contractor for Web Platform ($20K/month)
3. Pause Settings Redesign (lowest business impact)

**Result:** All teams at 85-95% allocation, preserve strategic work, protect Q4 OKRs.`
    }
  },
  teamMember: {
    teamPerformance: {
      query: "How is my team (Mobile Refresh) performing and what should we focus on?",
      response: `**Mobile Refresh Team Health Report:**

**Overall Score: 68/100 (âš ï¸ Yellow - Declining)**

**What's Going Well:**
- Delivery confidence on validated work: 85% (above average)
- Code quality: Strong (95% test coverage)
- Team collaboration: Good (peer reviews averaging 6 hours)

**What's Concerning:**
- **Workload:** 112% allocation (12% over capacity)
- **Morale:** Declining (2 team members flagged low satisfaction)
- **Velocity:** Down 25% from last quarter (45 â†’ 34 points)
- **Focus:** Juggling 8 initiatives (too much context switching)

**Your Current Sprint:**
- Payment Redesign (validated, 85% confidence) ✅
- Push Notifications (in validation, 70% confidence) âš ï¸
- Customer Portal (not validated, 45% confidence) 🔴

**Impact on OKRs:**
- You're contributing to **KR #2: Increase acquisition 15%**
- Customer Portal is critical path
- But team capacity threatens delivery

**What You Should Focus On:**
1. **Finish Payment Redesign** (almost done, high confidence)
2. **Complete Push Notifications validation** (don't start building until validated)
3. **Push back on Customer Portal** until validation complete or team gets help

**Talk to your manager about:** Reducing concurrent work from 8 â†’ 5 initiatives.`
    },
    deliveryBlocks: {
      query: "What's blocking our delivery confidence and how can we improve?",
      response: `**Delivery Confidence Analysis:**

**Current Confidence: 68% (Portfolio Average: 72%)**

**Top 3 Blockers:**

**1. Validation Gaps (40% of risk)**
- Customer Portal: Not validated
- Push Notifications: Partial validation only
- Impact: Building without customer proof = rework risk

**2. Capacity Overload (35% of risk)**
- Team at 112% allocation
- Context switching between 8 initiatives
- Sprint velocity down 25%
- Impact: Quality drops, timelines slip

**3. Technical Unknowns (25% of risk)**
- Payment Redesign has 3 unresolved technical spikes
- Push Notifications needs iOS cert renewal (procurement blocked)
- Impact: Unexpected delays mid-sprint

**How to Improve Confidence:**

**This Sprint (Immediate):**
- Complete technical spikes for Payment Redesign (2 days)
- Unblock iOS cert (escalate to manager)
- Confidence gain: +8%

**Next 2 Sprints:**
- Finish Push Notifications validation (stop building, test first)
- Deprioritize 2 of 8 initiatives
- Confidence gain: +12%

**Strategic (Next Quarter):**
- Implement validation-before-build policy
- Reduce max concurrent initiatives to 5
- Confidence gain: +15%

**Target Confidence: 85%+ (healthy range)**`
    }
  },
  productManager: {
    initiativeHealth: {
      query: "What's the health and delivery risk for my initiatives?",
      response: `**Initiative Health Dashboard**

**🔴 CRITICAL RISK: Customer Portal Redesign**
- **Delivery Timeline:** 3 weeks behind schedule (projected: Feb 28 â†’ Mar 21)
- **Velocity Trend:** Declining 25% (was 34 pts/sprint, now 26 pts/sprint)
- **Team Capacity:** Mobile Refresh at 112% allocation - burnout risk
- **Blockers:** 3 stories blocked (15% of current sprint scope)
  - Backend API dependency not ready
  - Design system component missing
  - Third-party integration delayed
- **Validation Status:** âš ï¸ NOT VALIDATED (building on assumptions)
- **Overall Health:** 🔴 Critical - Multiple risk factors converging

**Recommended Actions:**
1. Pause new scope until blockers cleared
2. Validate core assumptions before continuing build
3. Request capacity relief for Mobile team

---

**🟡 MEDIUM RISK: Analytics v2**
- **Delivery Timeline:** On track for target date (Jan 30)
- **Velocity Trend:** Stable (21 pts/sprint avg)
- **Team Capacity:** Data Analytics at 75% - healthy
- **Blockers:** 1 story blocked (5% impact)
  - Data warehouse schema approval pending
- **Validation Status:** 🟡 IN VALIDATION (40% confidence, needs more research)
- **Overall Health:** 🟡 Medium - Delivery solid but value uncertain

**Recommended Actions:**
1. Complete validation experiments this sprint
2. Be ready to pivot scope based on learnings
3. Consider MVPing to reduce investment risk

---

**🟢 HEALTHY: Payment Redesign**
- **Delivery Timeline:** On track (Feb 15 launch)
- **Velocity Trend:** Accelerating 15% (23 pts/sprint â†’ 26 pts/sprint)
- **Team Capacity:** Payments team at 85% - sustainable
- **Blockers:** 0 blocked stories
- **Validation Status:** ✅ VALIDATED (customer research complete, 85% confidence)
- **Overall Health:** 🟢 Healthy - Clear path to launch

**No action needed - maintain momentum**

---

**Portfolio Summary:**
- 1 initiative at critical risk requiring immediate intervention
- 1 initiative needs validation clarity before scaling investment
- 1 initiative healthy and on track
- **Key Insight:** 67% of your portfolio has delivery or validation risk - focus on Customer Portal blockers and Analytics validation to protect Q1 outcomes`
    },
    validationGaps: {
      query: "Which initiatives need validation and what are the specific gaps?",
      response: `**Validation Status Report:**

**🔴 NOT VALIDATED (3 initiatives):**

**Customer Portal Redesign**
- **Problem:** Missing problem statement (customer pain not articulated)
- **Assumptions:** 3 critical untested assumptions:
  1. "Customers want self-service portal" (no user research)
  2. "Mobile-first design increases engagement" (no data)
  3. "Current portal is main friction point" (no analytics)
- **Experiments:** NONE planned
- **Risk:** Very High (building $200K feature on faith)
- **Validation Plan:** 2-week discovery sprint needed

**Analytics v2**
- **Problem:** Feature-focused, not customer outcome focused
- **Assumptions:** "Customers need advanced analytics" (only 2 customers asked)
- **Experiments:** 1 smoke test (inconclusive, 40% signup)
- **Risk:** High (unclear customer value)
- **Validation Plan:** 10 customer interviews, usage analytics review

**Partner API v3**
- **Problem:** Solving technical debt, not partner problem
- **Assumptions:** "Partners want REST over GraphQL" (not validated)
- **Experiments:** NONE
- **Risk:** Medium (low business impact if wrong)
- **Validation Plan:** Survey 5 partners, prototype test

**🟡 IN VALIDATION (2 initiatives):**
- Push Notifications: 60% validated (needs iOS testing)
- Settings Redesign: 70% validated (needs accessibility testing)

**🟢 VALIDATED (3 initiatives):**
- Payment Redesign ✅
- Search Improvements ✅
- Performance Optimization ✅`
    },
    validationPlan: {
      query: "Generate a validation plan for Customer Portal with experiments and success criteria",
      response: `**Customer Portal Validation Plan**

**Phase 1: Problem Discovery (Week 1-2)**

**Activities:**
- 10 customer interviews (mix of power users and casual users)
- Analytics deep-dive: current portal usage patterns
- Support ticket analysis: portal-related issues
- Competitive analysis: 5 competitor portals

**Questions to Answer:**
- What specific tasks are customers trying to accomplish?
- Where do they get stuck today?
- Is "portal friction" actually the problem?

**Success Criteria:** Clear, validated problem statement + 3 customer quotes

**Phase 2: Solution Validation (Week 3-4)**

**Experiment 1: Fake Door Test**
- Create landing page with "New Portal" teaser
- Drive 500 customers to page
- Measure signup rate
- **Success:** >30% signup = strong interest

**Experiment 2: Lo-Fi Prototype**
- 5 usability tests with clickable prototype
- Measure task completion rate
- **Success:** >80% can complete key tasks

**Experiment 3: Value Proposition Test**
- A/B test email subject lines about portal benefits
- Measure open rate
- **Success:** >25% open rate = messaging resonates

**Phase 3: Build Decision (Week 5)**

**Go/No-Go Criteria:**
- ✅ Problem validated by 8+ of 10 customers
- ✅ Fake door test >30% signup
- ✅ Prototype usability >80%
- ✅ Team has capacity (not at risk)
- ✅ OKR impact quantified (>$500K value)

**If GO:** Proceed with MVP build (mobile-only first)
**If NO-GO:** Pivot to validated alternative solution

**Timeline:** 5 weeks validation before $200K build investment
**Cost:** $15K (researcher time + tools)
**Risk Reduction:** 70% (from "very high" to "low")`
    }
  }
};

const roleConfigs = {
  executive: {
    primaryMetric: { value: "$12.7M", label: "Portfolio Business Value", trend: "up" },
    secondaryMetrics: [
      { value: "1.49x", label: "ROI on Investment" },
      { value: "73%", label: "Aligned to Strategy" }
    ],
    insightKeys: ['businessImpact', 'strategicAlignment', 'strategicRisks']
  },
  resourceManager: {
    primaryMetric: { value: "112%", label: "Highest Team Allocation", trend: "up" },
    secondaryMetrics: [
      { value: "6", label: "Teams Managed" },
      { value: "42", label: "Total Engineers" }
    ],
    insightKeys: ['overallocation', 'rebalancing']
  },
  teamMember: {
    primaryMetric: { value: "68/100", label: "Team Health Score", trend: "down" },
    secondaryMetrics: [
      { value: "95%", label: "Team Capacity" },
      { value: "85%", label: "Delivery Confidence" }
    ],
    insightKeys: ['teamPerformance', 'deliveryBlocks']
  },
  productManager: {
    primaryMetric: { value: "3", label: "Initiatives Need Validation", trend: "down" },
    secondaryMetrics: [
      { value: "8", label: "Total Initiatives" },
      { value: "5/8", label: "OKRs on Track" }
    ],
    insightKeys: ['initiativeHealth', 'validationGaps', 'validationPlan']
  }
};

const AIProactiveDashboard = () => {
  const [currentRole, setCurrentRole] = useState('executive');
  const [showRoleMenu, setShowRoleMenu] = useState(false);
  const [insights, setInsights] = useState({});
  const [loadingInsights, setLoadingInsights] = useState(true);

  const roleNames = {
    executive: "Executive",
    resourceManager: "Resource Manager",
    teamMember: "Team Member",
    productManager: "Product Manager"
  };

  const roleIcons = {
    executive: <Target className="w-5 h-5" />,
    resourceManager: <Users className="w-5 h-5" />,
    teamMember: <CheckCircle className="w-5 h-5" />,
    productManager: <Lightbulb className="w-5 h-5" />
  };

  // Simulate AI generating insights on page load
  useEffect(() => {
    const generateInsights = async () => {
      setLoadingInsights(true);
      setInsights({});

      const roleInsights = aiInsights[currentRole];
      const config = roleConfigs[currentRole];

      if (!roleInsights || !config) {
        console.error('Missing data for role:', currentRole);
        setLoadingInsights(false);
        return;
      }

      // Simulate progressive insight loading
      for (let i = 0; i < config.insightKeys.length; i++) {
        await new Promise(resolve => setTimeout(resolve, 1500));
        const key = config.insightKeys[i];
        if (roleInsights[key]) {
          setInsights(prev => ({
            ...prev,
            [key]: roleInsights[key]
          }));
        }
      }

      setLoadingInsights(false);
    };

    generateInsights();
  }, [currentRole]);

  const formatAIResponse = (text) => {
    if (!text) return null;
    
    return text.split('\n').map((line, idx) => {
      if (line.startsWith('**') && line.endsWith('**')) {
        return <div key={idx} className="font-bold text-white mt-3 mb-1">{line.slice(2, -2)}</div>;
      }
      if (line.startsWith('- ')) {
        return <div key={idx} className="ml-4 text-purple-200 text-sm mb-1">• {line.slice(2)}</div>;
      }
      if (line.match(/^[🔴🟡🟢✅âš ï¸]/)) {
        return <div key={idx} className="text-white text-sm mb-2 mt-2">{line}</div>;
      }
      if (line.trim() === '') {
        return <div key={idx} className="h-2"></div>;
      }
      return <div key={idx} className="text-purple-200 text-sm mb-1">{line}</div>;
    });
  };

  const config = roleConfigs[currentRole];

  if (!config) {
    return <div className="text-white p-8">Error: Invalid role configuration</div>;
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-950 via-purple-950 to-slate-950 text-white">
      {/* Header */}
      <header className="border-b border-purple-800/30 bg-slate-900/50 backdrop-blur sticky top-0 z-50">
        <div className="px-6 py-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <a href="index.html" className="flex items-center gap-3 hover:opacity-80 transition-opacity">
              <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                <Sparkles className="w-6 h-6" />
              </div>
              <div>
                <h1 className="text-xl font-bold">AlignVue</h1>
                <p className="text-xs text-purple-300">AI-Powered Portfolio Intelligence</p>
              </div>
            </a>
          </div>

          <div className="flex items-center gap-4">
            {/* View Toggle */}
            <div className="flex items-center gap-2 px-3 py-2 bg-slate-800/50 border border-purple-500/30 rounded-lg">
              <span className="text-xs text-purple-300">View:</span>
              <select 
                onChange={(e) => window.location.href = e.target.value}
                value="role-dashboard.html"
                className="bg-transparent text-sm text-white border-none focus:outline-none cursor-pointer"
              >
                <option value="role-dashboard.html" className="bg-slate-800">Dashboard</option>
                <option value="role-dashboard-conversational.html" className="bg-slate-800">Conversational</option>
              </select>
            </div>

            <div className="relative z-[100]">
              <button
                onClick={() => setShowRoleMenu(!showRoleMenu)}
                className="flex items-center gap-2 px-4 py-2 bg-purple-600/20 border border-purple-500/30 rounded-lg hover:bg-purple-600/30 transition-colors"
              >
                {roleIcons[currentRole]}
                <span className="font-medium">{roleNames[currentRole]}</span>
                <ChevronDown className="w-4 h-4" />
              </button>
              
              {showRoleMenu && (
                <div 
                  className="absolute top-full right-0 mt-2 w-56 bg-slate-800 border border-purple-500/30 rounded-lg shadow-2xl z-[9999]"
                  style={{boxShadow: '0 20px 50px rgba(0,0,0,0.9)'}}
                >
                  {Object.keys(roleNames).map((role) => (
                    <button
                      key={role}
                      onClick={() => {
                        setCurrentRole(role);
                        setShowRoleMenu(false);
                      }}
                      className={`w-full flex items-center gap-3 px-4 py-3 hover:bg-purple-600/20 transition-colors first:rounded-t-lg last:rounded-b-lg ${
                        currentRole === role ? 'bg-purple-600/30' : ''
                      }`}
                    >
                      {roleIcons[role]}
                      <span>{roleNames[role]}</span>
                    </button>
                  ))}
                </div>
              )}
            </div>
            
            <button className="p-2 hover:bg-purple-600/20 rounded-lg transition-colors">
              <Settings className="w-5 h-5" />
            </button>
          </div>
        </div>
      </header>

      <div className="px-6 py-6 max-w-7xl mx-auto">
        {/* Role-Based Insight Panel */}
        <div className="bg-gradient-to-br from-slate-900/90 to-slate-800/90 border border-purple-500/30 rounded-2xl p-6 mb-6 backdrop-blur">
          <div className="flex items-center justify-between mb-6">
            <div>
              <h2 className="text-2xl font-bold mb-1">{roleNames[currentRole]} Dashboard</h2>
              <p className="text-purple-300 text-sm flex items-center gap-2">
                <Sparkles className="w-4 h-4" />
                AI-generated insights for your role
              </p>
            </div>
            <button
              onClick={() => window.vuesenseModal && window.vuesenseModal.open()}
              className="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-colors font-medium"
            >
              <MessageSquare className="w-4 h-4" />
              Ask VueSense AI
            </button>
          </div>

          {/* Metrics Grid */}
          <div className="grid grid-cols-3 gap-4 mb-6">
            <div className="col-span-1 bg-gradient-to-br from-purple-600/20 to-pink-600/20 border border-purple-500/30 rounded-xl p-6">
              <div className="flex items-start justify-between mb-2">
                <span className="text-purple-300 text-sm font-medium">{config.primaryMetric.label}</span>
                {config.primaryMetric.trend === 'up' ? (
                  <TrendingUp className="w-4 h-4 text-green-400" />
                ) : (
                  <AlertTriangle className="w-4 h-4 text-yellow-400" />
                )}
              </div>
              <div className="text-4xl font-bold mb-1">{config.primaryMetric.value}</div>
            </div>

            {config.secondaryMetrics.map((metric, idx) => (
              <div key={idx} className="bg-slate-800/50 border border-purple-500/20 rounded-xl p-6">
                <span className="text-purple-300 text-sm font-medium block mb-2">{metric.label}</span>
                <div className="text-3xl font-bold">{metric.value}</div>
              </div>
            ))}
          </div>

          {/* AI-Generated Insights */}
          <div className="space-y-4">
            {config.insightKeys.map((key, idx) => {
              const insight = insights[key];
              const isLoading = !insight && (loadingInsights || Object.keys(insights).length <= idx);

              return (
                <div
                  key={key}
                  className="bg-slate-800/50 border border-purple-500/30 rounded-xl p-5"
                >
                  {isLoading ? (
                    <div className="flex items-center gap-3">
                      <Loader2 className="w-5 h-5 text-purple-400 animate-spin" />
                      <div>
                        <div className="text-sm font-medium text-purple-300 mb-1">
                          VueSense AI is analyzing...
                        </div>
                        <div className="text-xs text-purple-400">
                          Processing your portfolio data
                        </div>
                      </div>
                    </div>
                  ) : insight ? (
                    <div>
                      <div className="flex items-start gap-3 mb-3">
                        <Sparkles className="w-5 h-5 text-purple-400 flex-shrink-0 mt-1" />
                        <div className="flex-1">
                          <div className="text-sm font-medium text-purple-300 mb-1">
                            {insight.query}
                          </div>
                        </div>
                      </div>
                      <div className="ml-8 pl-4 border-l-2 border-purple-500/30">
                        {formatAIResponse(insight.response)}
                      </div>
                    </div>
                  ) : (
                    <div className="text-sm text-red-400">Error loading insight</div>
                  )}
                </div>
              );
            })}
          </div>

          {/* Ask More */}
          {!loadingInsights && (
            <div className="mt-6 p-4 bg-purple-600/10 border border-purple-500/30 rounded-lg">
              <div className="text-center text-sm text-purple-300">
                <button
                  onClick={() => window.vuesenseModal && window.vuesenseModal.open()}
                  className="text-purple-400 hover:text-purple-300 font-medium underline"
                >
                  Ask VueSense AI more questions
                </button>
                {' '}about your portfolio
              </div>
            </div>
          )}
        </div>

        {/* Compact Board View */}
        <div className="bg-gradient-to-br from-slate-900/90 to-slate-800/90 border border-purple-500/30 rounded-2xl p-6">
          <div className="flex items-center gap-4 mb-4 border-b border-purple-500/20 pb-3">
            <button className="px-4 py-2 bg-purple-600/30 border-b-2 border-purple-500 text-sm font-medium">
              Portfolio Board
            </button>
            <button className="px-4 py-2 text-sm font-medium text-purple-300 hover:text-white">
              Team Health
            </button>
          </div>
          
          <div className="grid grid-cols-8 gap-2">
            {[1, 2, 3, 4, 5, 6, 7, 8].map((i) => (
              <div
                key={i}
                className="aspect-square bg-gradient-to-br from-purple-600/20 to-pink-600/20 border border-purple-500/30 rounded-lg flex items-center justify-center text-xs font-bold cursor-pointer hover:scale-105 transition-transform"
              >
                {i}
              </div>
            ))}
          </div>
          <p className="text-center text-xs text-purple-300 mt-4">
            Click any initiative to see details
          </p>
        </div>
      </div>

    </div>
  );
};


        
        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AIProactiveDashboard />);
        
        // Initialize VueSense AI Chatbot
        window.addEventListener('DOMContentLoaded', () => {
            window.vuesenseModal = new VueSenseModal({
                position: 'center',
                size: 'large',
                closeOnBackdrop: true
            });
        });
    </script>
    
    <!-- Sidebar Toggle Script -->
    <script>
        // Sidebar toggle functionality
        document.getElementById('sidebar-toggle')?.addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar-nav');
            sidebar.classList.toggle('collapsed');
        });
        
        // Click outside to close sidebar on mobile
        document.getElementById('sidebar-overlay')?.addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar-nav');
            sidebar.classList.remove('collapsed');
        });
    </script>
</body>
</html>
